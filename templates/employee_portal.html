{% extends "base.html" %}

{% block title %}Mon Espace Salari√© - Sansoucy SIRH{% endblock %}

{% block content %}
<div style="padding: 20px;">
    <!-- En-t√™te de bienvenue -->
    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 8px; margin-bottom: 30px;">
        <h1 style="margin: 0 0 10px 0;">üëã Bienvenue {{ user.first_name }}!</h1>
        <p style="margin: 0; font-size: 16px;">Voici votre espace personnel du Sansoucy SIRH</p>
    </div>

    <!-- Grille d'info personnel -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
        
        <!-- Carte: Mes Informations -->
        <div style="background: white; border: 1px solid #ddd; border-radius: 8px; padding: 20px;">
            <h3 style="margin-top: 0; color: #667eea;">üìã Mes Informations Personnelles</h3>
            <table style="width: 100%; font-size: 14px;">
                <tr>
                    <td style="font-weight: bold; width: 40%; padding: 8px 0;">ID Employ√©:</td>
                    <td style="padding: 8px 0;">{{ employee.employee_id }}</td>
                </tr>
                <tr>
                    <td style="font-weight: bold; padding: 8px 0;">Profession:</td>
                    <td style="padding: 8px 0;">{{ employee.profession.label }}</td>
                </tr>
                <tr>
                    <td style="font-weight: bold; padding: 8px 0;">Statut:</td>
                    <td style="padding: 8px 0;">
                        {% if employee.status == 'active' %}
                            <span style="background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px;">Actif</span>
                        {% elif employee.status == 'on_leave' %}
                            <span style="background: #FF9800; color: white; padding: 4px 8px; border-radius: 4px;">En cong√©</span>
                        {% else %}
                            <span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px;">Inactif</span>
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold; padding: 8px 0;">Email:</td>
                    <td style="padding: 8px 0;">{{ user.email }}</td>
                </tr>
                <tr>
                    <td style="font-weight: bold; padding: 8px 0;">T√©l√©phone:</td>
                    <td style="padding: 8px 0;">{{ employee.phone|default:"Non renseign√©" }}</td>
                </tr>
            </table>
            <hr style="margin: 15px 0; border: none; border-top: 1px solid #eee;">
            <a href="#" style="color: #667eea; text-decoration: none;">‚úèÔ∏è Modifier mes donn√©es personnelles ‚Üí</a>
        </div>

        <!-- Carte: Mon Contrat -->
        <div style="background: white; border: 1px solid #ddd; border-radius: 8px; padding: 20px;">
            <h3 style="margin-top: 0; color: #667eea;">üìÑ Mon Contrat Actuel</h3>
            {% if contracts %}
                {% for contract in contracts|slice:":1" %}
                <table style="width: 100%; font-size: 14px;">
                    <tr>
                        <td style="font-weight: bold; width: 40%; padding: 8px 0;">Type:</td>
                        <td style="padding: 8px 0;">{{ contract.get_contract_type_display }}</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold; padding: 8px 0;">Depuis:</td>
                        <td style="padding: 8px 0;">{{ contract.start_date|date:"d/m/Y" }}</td>
                    </tr>
                    {% if contract.end_date %}
                    <tr>
                        <td style="font-weight: bold; padding: 8px 0;">Jusqu'au:</td>
                        <td style="padding: 8px 0;">{{ contract.end_date|date:"d/m/Y" }}</td>
                    </tr>
                    {% endif %}
                    <tr>
                        <td style="font-weight: bold; padding: 8px 0;">Heures/semaine:</td>
                        <td style="padding: 8px 0;">{{ contract.working_hours_per_week }}h</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold; padding: 8px 0;">Salaire mensuel:</td>
                        <td style="padding: 8px 0;">{{ contract.monthly_salary|default:contract.hourly_rate }}‚Ç¨</td>
                    </tr>
                </table>
                {% endfor %}
            {% else %}
                <p style="color: #999; font-style: italic;">Aucun contrat actif actuellement</p>
            {% endif %}
        </div>

    </div>

    <!-- Mes Plannings -->
    <div style="background: white; border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 30px;">
        <h3 style="color: #667eea; margin-top: 0;">üìÖ Mon Planning du Mois</h3>
        {% if shifts %}
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f5f5f5; border-bottom: 2px solid #ddd;">
                        <th style="padding: 12px; text-align: left;">üìÖ Date</th>
                        <th style="padding: 12px; text-align: left;">‚è∞ Type</th>
                        <th style="padding: 12px; text-align: left;">üïê Horaire</th>
                        <th style="padding: 12px; text-align: left;">üìç Statut</th>
                    </tr>
                </thead>
                <tbody>
                    {% for shift in shifts %}
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 12px;">{{ shift.date|date:"d/m/Y (l)" }}</td>
                        <td style="padding: 12px;">{{ shift.shift_type.name }}</td>
                        <td style="padding: 12px;">{{ shift.start_time|time:"H:i" }} - {{ shift.end_time|time:"H:i" }}</td>
                        <td style="padding: 12px;">
                            {% if shift.status == 'planned' %}
                                <span style="background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px;">Pr√©vu</span>
                            {% elif shift.status == 'ongoing' %}
                                <span style="background: #FF9800; color: white; padding: 4px 8px; border-radius: 4px;">En cours</span>
                            {% elif shift.status == 'completed' %}
                                <span style="background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px;">Compl√©t√©</span>
                            {% else %}
                                <span style="background: #999; color: white; padding: 4px 8px; border-radius: 4px;">{{ shift.get_status_display }}</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p style="color: #999; font-style: italic;">Aucun planning pour ce mois</p>
        {% endif %}
    </div>

    <!-- Ma Feuille de Temps -->
    <div style="background: white; border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 30px;">
        <h3 style="color: #667eea; margin-top: 0;">‚è±Ô∏è Ma Feuille de Temps</h3>
        {% if current_timesheet %}
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                <div style="background: #f5f5f5; padding: 15px; border-radius: 4px; text-align: center;">
                    <div style="font-size: 28px; font-weight: bold; color: #667eea;">{{ current_timesheet.total_hours|default:"--" }}</div>
                    <div style="font-size: 14px; color: #666;">Heures travaill√©es</div>
                </div>
                <div style="background: #f5f5f5; padding: 15px; border-radius: 4px; text-align: center;">
                    <div style="font-size: 14px; font-weight: bold; color: #666;">Mois {{ current_timesheet.month }}/{{ current_timesheet.year }}</div>
                    <div style="font-size: 14px; margin-top: 8px;">
                        {% if current_timesheet.status == 'draft' %}
                            <span style="background: #9E9E9E; color: white; padding: 4px 8px; border-radius: 4px;">Brouillon</span>
                        {% elif current_timesheet.status == 'submitted' %}
                            <span style="background: #FF9800; color: white; padding: 4px 8px; border-radius: 4px;">Soumis</span>
                        {% elif current_timesheet.status == 'approved' %}
                            <span style="background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px;">Approuv√©</span>
                        {% else %}
                            <span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px;">Rejet√©</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% if current_timesheet.status == 'draft' %}
            <div style="margin-top: 15px;">
                <a href="{% url 'timesheet_edit' current_timesheet.id %}" style="display: inline-block; background: #667eea; color: white; padding: 10px 20px; border-radius: 4px; text-decoration: none;">‚úèÔ∏è √âditer & Soumettre</a>
            </div>
            {% endif %}
        {% else %}
            <p style="color: #999; font-style: italic;">Aucune feuille de temps pour ce mois</p>
            <a href="{% url 'timesheet_create' %}" style="display: inline-block; background: #667eea; color: white; padding: 10px 20px; border-radius: 4px; text-decoration: none;">‚ûï Cr√©er une feuille de temps</a>
        {% endif %}
    </div>

    <!-- Liens rapides -->
    <div style="background: #f5f5f5; border-radius: 8px; padding: 20px;">
        <h3 style="margin-top: 0; color: #333;">Acc√®s Rapides</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
            <a href="{% url 'planning' %}" style="display: block; background: white; padding: 15px; text-align: center; border-radius: 4px; text-decoration: none; color: #667eea; border: 1px solid #ddd; transition: all 0.3s;">
                <div style="font-size: 20px;">üìÖ</div>
                <div style="font-size: 14px; margin-top: 5px;">Planning</div>
            </a>
            <a href="{% url 'timesheets' %}" style="display: block; background: white; padding: 15px; text-align: center; border-radius: 4px; text-decoration: none; color: #667eea; border: 1px solid #ddd; transition: all 0.3s;">
                <div style="font-size: 20px;">‚è±Ô∏è</div>
                <div style="font-size: 14px; margin-top: 5px;">Feuilles de Temps</div>
            </a>
            <a href="{% url 'employee_documents' %}" style="display: block; background: white; padding: 15px; text-align: center; border-radius: 4px; text-decoration: none; color: #667eea; border: 1px solid #ddd; transition: all 0.3s;">
                <div style="font-size: 20px;">üìÅ</div>
                <div style="font-size: 14px; margin-top: 5px;">Mes Documents</div>
            </a>
            <a href="#" style="display: block; background: white; padding: 15px; text-align: center; border-radius: 4px; text-decoration: none; color: #667eea; border: 1px solid #ddd; transition: all 0.3s;">
                <div style="font-size: 20px;">üì±</div>
                <div style="font-size: 14px; margin-top: 5px;">Mon Profil</div>
            </a>
        </div>
    </div>

</div>
{% endblock %}
