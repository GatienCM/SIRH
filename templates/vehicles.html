{% extends "base.html" %}

{% block header_actions %}
<a href="{% url 'vehicle_create' %}" class="btn">â• Ajouter</a>
{% endblock %}

{% block content %}
<div class="search-box">
    <form method="GET" style="display: flex; gap: 10px; width: 100%;">
        <select name="status" style="padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px;">
            <option value="">Tous les statuts</option>
            <option value="available" {% if status == 'available' %}selected{% endif %}>Disponibles</option>
            <option value="maintenance" {% if status == 'maintenance' %}selected{% endif %}>En Maintenance</option>
            <option value="retired" {% if status == 'retired' %}selected{% endif %}>RetraitÃ©s</option>
        </select>
        <button type="submit" class="btn">Filtrer</button>
    </form>
</div>

{% if vehicles %}
<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>ğŸš— Marque & ModÃ¨le</th>
                <th>ğŸ“ Immatriculation</th>
                <th>ğŸ“… Date Achat</th>
                <th>â›½ Carburant</th>
                <th>ğŸ“Š Statut</th>
                <th>ğŸ› ï¸ Maintenance</th>
                <th>âš™ï¸ Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for vehicle in vehicles %}
            <tr>
                <td><strong>{{ vehicle.brand }} {{ vehicle.model }}</strong></td>
                <td>{{ vehicle.registration_number }}</td>
                <td>{{ vehicle.purchase_date|date:"d/m/Y" }}</td>
                <td>{{ vehicle.fuel_type }}</td>
                <td>
                    {% if vehicle.status == 'available' %}
                        <span class="badge badge-success">âœ“ Disponible</span>
                    {% elif vehicle.status == 'maintenance' %}
                        <span class="badge badge-warning">ğŸ› ï¸ Maintenance</span>
                    {% else %}
                        <span class="badge badge-danger">âœ— RetraitÃ©</span>
                    {% endif %}
                </td>
                <td>
                    {% if vehicle.last_maintenance %}
                        {{ vehicle.last_maintenance|date:"d/m/Y" }}
                    {% else %}
                        <em style="color: #999;">Jamais</em>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'vehicle_edit' vehicle.id %}" class="btn" style="padding: 5px 10px; font-size: 0.85em;">âœï¸ Ã‰diter</a>
                    <a href="{% url 'vehicle_delete' vehicle.id %}" class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.85em;" onclick="return confirm('Supprimer ce vÃ©hicule ?')">ğŸ—‘ï¸ Supprimer</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<p style="margin-top: 20px; color: #666; text-align: right;">
    <strong>Total :</strong> {{ vehicles.count }} vÃ©hicule(s)
</p>
{% else %}
<div class="empty-state">
    <p>ğŸ˜• Aucun vÃ©hicule trouvÃ©</p>
    <a href="{% url 'vehicle_create' %}" class="btn">â• Ajouter un vÃ©hicule</a>
</div>
{% endif %}
{% endblock %}
