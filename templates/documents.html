{% extends "base.html" %}

{% block page_title %}üìÅ Gestion des Documents{% endblock %}

{% block content %}
<div style="max-width: 1400px; margin: 0 auto; padding: 20px;">
    <h1 style="color: #333; margin-bottom: 30px;">üìÅ Gestion √âlectronique des Documents</h1>

    <!-- Messages -->
    {% if messages %}
    <div style="margin-bottom: 20px;">
        {% for message in messages %}
        <div style="background: {% if message.tags == 'success' %}#4CAF50{% elif message.tags == 'error' %}#f44336{% else %}#2196F3{% endif %}; color: white; padding: 15px; border-radius: 4px; margin-bottom: 10px;">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Statistiques -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <div style="font-size: 28px; font-weight: bold; color: #667eea;">{{ stats.total_employees }}</div>
            <div style="color: #999; font-size: 14px; margin-top: 5px;">Employ√©s actifs</div>
        </div>
        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <div style="font-size: 28px; font-weight: bold; color: #667eea;">{{ stats.total_documents }}</div>
            <div style="color: #999; font-size: 14px; margin-top: 5px;">Documents totaux</div>
        </div>
        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <div style="font-size: 28px; font-weight: bold; color: #667eea;">{{ stats.employees_with_docs }}</div>
            <div style="color: #999; font-size: 14px; margin-top: 5px;">Employ√©s avec documents</div>
        </div>
    </div>

    <!-- Info -->
    <div style="background: #e3f2fd; border-left: 4px solid #2196F3; padding: 15px; margin-bottom: 30px; border-radius: 4px;">
        <p style="margin: 0; color: #1976D2;">
            üí° Cliquez sur un employ√© pour g√©rer ses documents (contrats, dipl√¥mes, bulletins, etc.)
        </p>
    </div>

    <!-- Liste des employ√©s -->
    <div style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <h2 style="margin-top: 0; color: #333; margin-bottom: 20px;">üë• S√©lectionner un Employ√©</h2>
        
        {% if employees %}
        <div style="display: grid; gap: 15px;">
            {% for employee in employees %}
            <a href="{% url 'employee_documents_admin' employee.id %}" style="display: flex; align-items: center; justify-content: space-between; padding: 20px; background: #f9f9f9; border: 2px solid #e0e0e0; border-radius: 8px; text-decoration: none; color: #333; transition: all 0.3s;" onmouseover="this.style.background='#667eea'; this.style.borderColor='#667eea'; this.style.color='white';" onmouseout="this.style.background='#f9f9f9'; this.style.borderColor='#e0e0e0'; this.style.color='#333';">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="font-size: 36px;">üë§</div>
                    <div>
                        <div style="font-size: 18px; font-weight: 600;">{{ employee.user.first_name }} {{ employee.user.last_name }}</div>
                        <div style="font-size: 14px; opacity: 0.7;">{{ employee.employee_id }} - {{ employee.profession.label }}</div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 20px;">
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: bold;">{{ employee.document_count }}</div>
                        <div style="font-size: 12px; opacity: 0.7;">document{% if employee.document_count > 1 %}s{% endif %}</div>
                    </div>
                    {% if employee.missing_documents > 0 %}
                    <div style="display: inline-flex; align-items: center; gap: 6px; background: #fff3cd; color: #856404; border: 1px solid #ffeeba; padding: 6px 10px; border-radius: 999px; font-size: 12px; font-weight: 600;">
                        {{ employee.missing_documents }} manquant{% if employee.missing_documents > 1 %}s{% endif %}
                    </div>
                    {% else %}
                    <div style="display: inline-flex; align-items: center; gap: 6px; background: #d4edda; color: #155724; border: 1px solid #c3e6cb; padding: 6px 10px; border-radius: 999px; font-size: 12px; font-weight: 600;">
                        Dossier complet
                    </div>
                    {% endif %}
                    <div style="font-size: 24px;">‚Üí</div>
                </div>
            </a>
            {% endfor %}
        </div>
        {% else %}
        <p style="color: #999; text-align: center; padding: 40px;">Aucun employ√© actif</p>
        {% endif %}
    </div>
</div>

<style>
a:hover {
    transform: translateX(5px);
}
</style>

{% endblock %}
